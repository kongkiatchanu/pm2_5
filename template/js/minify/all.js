var osmUrl="https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",osmAttrib='Map data © <a href="https://openstreetmap.org">OpenStreetMap</a> contributors',opacity=1,OpenStreetMap=new L.tileLayer(osmUrl,{maxZoom:18,attribution:osmAttrib,opacity:opacity}),Topographic=new L.esri.basemapLayer("Topographic",{opacity:opacity}),Streets=new L.esri.basemapLayer("Streets",{opacity:opacity}),NationalGeographic=new L.esri.basemapLayer("NationalGeographic",{opacity:opacity}),Oceans=new L.esri.basemapLayer("Oceans",{opacity:opacity}),Gray=new L.esri.basemapLayer("Gray",{opacity:opacity}),DarkGray=new L.esri.basemapLayer("DarkGray"),Imagery=new L.esri.basemapLayer("Imagery"),ShadedRelief=new L.esri.basemapLayer("ShadedRelief",{opacity:opacity}),config={DataFormat:"th",DataLang:"th",DataHotspotType:"MODIS",pm_region:"",pm_top:"All",curentStation:{},station_point:null,location:{lat:null,lon:null,dis:"All"},province_sel:null,province_all:[],pmLocations:{},rsForecast:{},rsProphecy:{},rsProphecy_region:""},optionText_th={title:"ค่า PM2.5 รายชั่วโมง จากสถานีเครื่องวัดที่อยู่ในระยะ",rgtitle:"อันดับค่าฝุ่นทุกสถานี",rgtime:"",station:"สถานีเครื่องวัด",dis:"ระยะห่าง (km)",pm:"PM2.5 (μg/m<sup>3</sup>)",hour_no:"ลำดับ",hour_name:"สถานีเครื่องวัด",hour_value:"PM2.5 (μg/m<sup>3</sup>)",hour_value10:"PM10 (μg/m<sup>3</sup>)"},optionText_en={title:"Value of PM2.5 hourly from station in range",rgtitle:"Average top ranking",rgtime:"",station:"Stations",dis:"Distance (km)",pm:"PM2.5 (μg/m<sup>3</sup>)",hour_no:"No.",hour_name:"Stations",hour_value:"PM2.5 (μg/m<sup>3</sup>)",hour_value10:"PM10 (μg/m<sup>3</sup>)"};function convertDateFormatDay(t,a){var o=t.split(" "),i=o[0].split("-"),e=i[2]+"/"+i[1]+"/"+i[0];o[1].substring(0,5);return'<span class="px-1"><i class="far fa-calendar-alt"></i> '+e+"</span>"}function convertDateFormatHour(t,a){var o=t.split(" "),i=o[0].split("-");i[2],i[1],i[0];return'<span class="px-1"><i class="far fa-clock"></i> '+o[1].substring(0,5)+"</span>"}var pathname=window.location.pathname;function getProvinceName(t){for(let a=0;a<config.province_all.length;a++)for(let o=0;o<config.province_all[a].provinces.length;o++)if(config.province_all[a].provinces[o].province_code==t)return config.province_all[a].provinces[o].province_name_th}function getBG(t,a){var o="";if(t)return"th"==a?t<=25?o='style="background-color: rgb(0,191,243)"':t>25&&t<=37?o='style="background-color: rgb(0,166,81)"':t>37&&t<=50?o='style="background-color: rgb(253,192,78)"':t>20&&t<=90?o='style="background-color: rgb(242,101,34)"':t>90&&t<=999&&(o='style="background-color: rgb(205,0,0)"'):t<=12?o='style="background-color: rgb(0, 153, 107)"':t>12&&t<=35?o='style="background-color: rgb(253,192,78)"':t>35&&t<=55?o='style="background-color: rgb(235, 132, 63)"':t>55&&t<=150?o='style="background-color: rgb(205,0,0)"':t>150&&t<=250?o='style="background-color: rgb(129, 21, 185)"':t>250&&(o='style="background-color: rgb(160, 7, 54)"'),o}function createProphecy(t){for(let r=0;r<config.rsProphecy.length;r++){var a=config.rsProphecy[r].zone_id;if(t){if(a==t){$(".forecast-title"+a).html(config.rsProphecy[r].zone_name_th);var o="";if(config.rsProphecy[r].provinces.length)for(let t=0;t<config.rsProphecy[r].provinces.length;t++)if(config.rsProphecy[r].provinces[t].stations.length)for(let a=0;a<config.rsProphecy[r].provinces[t].stations.length;a++){var i=config.rsProphecy[r].provinces[t].stations[a].pm25.PM25,e=null,n=null,c=null;if((l=config.rsProphecy[r].provinces[t].stations[a].weather).length)for(index_forecast=0;index_forecast<l.length;index_forecast++){var s=l[index_forecast].ForecastDate.split("T");$("#today").val()==s[0]&&(e=l[index_forecast].PM25),$("#today_add").val()==s[0]&&(n=l[index_forecast].PM25),$("#today_add2").val()==s[0]&&(c=l[index_forecast].PM25)}o+="<tr>",o+="<td>"+config.rsProphecy[r].provinces[t].stations[a].location_name+"</td>",o+="<td>"+config.rsProphecy[r].provinces[t].province_name_th+"</td>",o+='<td class="text-center"><div class="pm-bage" '+getBG(i,config.DataFormat)+">"+i+"</div></td>",o+='<td class="text-center"><div class="pm-bage" '+getBG(e,config.DataFormat)+">"+e+"</div></td>",o+='<td class="text-center"><div class="pm-bage" '+getBG(n,config.DataFormat)+">"+n+"</div></td>",o+='<td class="text-center"><div class="pm-bage" '+getBG(c,config.DataFormat)+">"+c+"</div></td>",o+="</tr>"}$("#tblProphecy"+a+" tbody").html(o),$("#box_"+a).show()}}else{$(".forecast-title"+a).html(config.rsProphecy[r].zone_name_th);o="";if(config.rsProphecy[r].provinces.length)for(let t=0;t<config.rsProphecy[r].provinces.length;t++)if(config.rsProphecy[r].provinces[t].stations.length)for(let a=0;a<config.rsProphecy[r].provinces[t].stations.length;a++){var l;i=config.rsProphecy[r].provinces[t].stations[a].pm25.PM25,e=null,n=null,c=null;if((l=config.rsProphecy[r].provinces[t].stations[a].weather).length)for(index_forecast=0;index_forecast<l.length;index_forecast++){s=l[index_forecast].ForecastDate.split("T");$("#today_add").val()==s[0]&&(e=l[index_forecast].PM25),$("#today_add2").val()==s[0]&&(n=l[index_forecast].PM25),$("#today_add3").val()==s[0]&&(c=l[index_forecast].PM25)}o+="<tr>",o+="<td>"+config.rsProphecy[r].provinces[t].stations[a].location_name+"</td>",o+="<td>"+config.rsProphecy[r].provinces[t].province_name_th+"</td>",o+='<td class="text-center"><div class="pm-bage" '+getBG(i,config.DataFormat)+">"+i+"</div></td>",o+='<td class="text-center"><div class="pm-bage" '+getBG(e,config.DataFormat)+">"+e+"</div></td>",o+='<td class="text-center"><div class="pm-bage" '+getBG(n,config.DataFormat)+">"+n+"</div></td>",o+='<td class="text-center"><div class="pm-bage" '+getBG(c,config.DataFormat)+">"+c+"</div></td>",o+="</tr>"}$("#tblProphecy"+a+" tbody").html(o),$("#box_"+a).show(),$("#box_"+a).show()}}$(".table").DataTable({bDestroy:!0}),$(".loader").hide()}function createForecastChart(){if(config.rsForecast&&("th"==config.DataLang?($("#rgname").html("คาดการณ์ค่าฝุ่น PM2.5"),$("#rgname2").html(config.rsForecast.station_name_th)):($("#rgname").html("Forecast PM2.5"),$("#rgname2").html(config.rsForecast.station_name_en)),config.rsForecast.is_display_forecast))for(let t=1;t<config.rsForecast.forecast_days.length;t++){let a=config.rsForecast.forecast_days[t].forecast_hours,o=[],i=[],e=[],n=[];for(let t=0;t<a.length;t++)o.push(a[t].time),n.push(a[t].hour_avg_pm25),i.push("th"===config.DataFormat?"rgb("+a[t].hour_th_color+")":"rgb("+a[t].hour_us_color+")"),e.push("th"===config.DataFormat?"rgb("+a[t].hour_th_color+")":"rgb("+a[t].hour_us_color+")");"th"==config.DataFormat?($("#card_"+t+" .bg_icon").attr("src","/template/image/"+config.rsForecast.forecast_days[t].day_th_icon+".svg"),$("#card_"+t+" .bg_color").css("background-color","rgba("+config.rsForecast.forecast_days[t].day_th_color+", 1)")):($("#card_"+t+" .bg_icon").attr("src","/template/image/"+config.rsForecast.forecast_days[t].day_us_icon+".svg"),$("#card_"+t+" .bg_color").css("background-color","rgba("+config.rsForecast.forecast_days[t].day_us_color+", 1)")),"th"==config.DataLang?($("#card_"+t+" .day_name").html(config.rsForecast.forecast_days[t].day_name_th),$("#card_"+t+" .avg_name").html("PM2.5 เฉลี่ย")):($("#card_"+t+" .day_name").html(config.rsForecast.forecast_days[t].day_name_en),$("#card_"+t+" .avg_name").html("PM2.5 Average")),new Chart(document.getElementById("my-chart-"+t),{type:"bar",data:{labels:o,datasets:[{label:"# of avg pm25",data:n,backgroundColor:i,borderColor:e}]},options:{legend:{display:!1},responsive:!0,scales:{yAxes:[{ticks:{min:0,stepSize:.2}}]}}})}}function getTblResult(){if(config.pmLocations){var t;t="th"==config.DataLang?optionText_th:optionText_en;var a=0,o='<div class="row"><div class="col-12"><div class="table hourly"><div class="table-head"><div class="table-row"><div class="table-column">'+t.station+'</div><div class="table-column">'+t.dis+'</div><div class="table-column">'+t.pm+'</div></div></div><div class="table-body">',i="";$.each(config.pmLocations,function(t,o){if("All"==config.location.dis)i+='<div><div class="table-row" id="row_'+o.id+'"><button class="btn btn-table" onclick="nearStation('+o.id+')">',"th"==config.DataLang?i+='<div class="table-column">'+o.dustboy_name+"</div>":i+='<div class="table-column">'+o.dustboy_name_en+"</div>",i+='<div class="table-column">'+parseFloat(o.distance).toFixed(2)+"</div>","th"==config.DataFormat?i+='<div class="table-column"><div class="bg-blue" style="background-color: rgb('+o.th_color+');">'+o.pm25+"</div></div>":i+='<div class="table-column"><div class="bg-blue" style="background-color: rgb('+o.us_color+');">'+o.pm25+"</div></div>",i+="</button></div></div>",0==a&&(config.station_point||(config.station_point=o.id)),a++;else{var e=config.location.dis.split(" ");parseFloat(o.distance)<parseFloat(e[0])&&(i+='<div><div class="table-row"><button class="btn btn-table">',"th"==config.DataLang?i+='<div class="table-column">'+o.dustboy_name+"</div>":i+='<div class="table-column">'+o.dustboy_name_en+"</div>",i+='<div class="table-column">'+parseFloat(o.distance).toFixed(2)+"</div>","th"==config.DataFormat?i+='<div class="table-column"><div class="bg-blue" style="background-color: rgb('+o.th_color+');">'+o.pm25+"</div></div>":i+='<div class="table-column"><div class="bg-blue" style="background-color: rgb('+o.us_color+');">'+o.pm25+"</div></div>",i+="</button></div></div>",0==a&&(config.station_point||(config.station_point=o.id)),a++)}}),$("#pagename").html(t.title),$("#tblResult").html(o+i+"</div></div></div></div>"),$("#tblResult").show(),$(".standard_sqi_legend_footer").show(),a>0&&$(".loader").hide()}}function getTblPMDayResult(){if(config.pmLocations){var t;config.province_sel&&$("#rgname").html("อันดับค่าฝุ่น จังหวัด"+getProvinceName(config.province_sel)),t="th"==config.DataLang?optionText_th:optionText_en;var a=0,o='<div class="row"><div class="col-12"><div class="table hourly"><div class="table-head"><div class="table-row"><div class="table-column">'+t.hour_no+'</div><div class="table-column" style="display: flex;">'+t.hour_name+'</div><div class="table-column">'+t.hour_value+'</div><div class="table-column">AQI</div></div></div><div class="table-body">',i="",e=0;$.each(config.pmLocations,function(t,o){config.province_sel?o.province_code==config.province_sel&&(e++,"All"==config.pm_top&&o.daily_pm25>0?(config.pm_region||$(".update-time").html("ข้อมูลเฉลี่ยรายวัน "+convertDateFormatDay(o.log_datetime)+" "+convertDateFormatHour(o.log_datetime),pathname),i+='<div><div class="table-row" id="row_'+o.id+'"><button class="btn btn-table" onclick="nearStation2('+o.id+')">',i+='<div class="table-column">'+e+"</div>","th"==config.DataLang?i+='<div class="table-column table-column-custom">'+o.dustboy_name+"</div>":i+='<div class="table-column table-column-custom">'+o.dustboy_name_en+"</div>","th"==config.DataFormat?(i+='<div class="table-column"><div class="bg-blue" style="background-color: rgb('+o.daily_th_color+');">'+o.daily_pm25+"</div></div>",i+='<div class="table-column"><div class="bg-blue" style="background-color: rgb('+o.daily_th_color+');">'+o.daily_pm25_th_aqi+"</div></div>"):(i+='<div class="table-column"><div class="bg-blue" style="background-color: rgb('+o.daily_us_color+');">'+o.daily_pm25+"</div></div>",i+='<div class="table-column"><div class="bg-blue" style="background-color: rgb('+o.daily_us_color+');">'+o.daily_pm25_us_aqi+"</div></div>"),i+="</button></div></div>",0==a&&(config.station_point||(config.station_point=o.id)),a++):e<=config.pm_top&&o.daily_pm25>0&&(config.pm_region||$(".update-time").html("ข้อมูลเฉลี่ยรายชั่วโมง "+convertDateFormatDay(o.log_datetime)+" "+convertDateFormatHour(o.log_datetime),pathname),i+='<div><div class="table-row" id="row_'+o.id+'"><button class="btn btn-table" onclick="nearStation2('+o.id+')">',i+='<div class="table-column">'+e+"</div>","th"==config.DataLang?i+='<div class="table-column table-column-custom">'+o.dustboy_name+"</div>":i+='<div class="table-column table-column-custom">'+o.dustboy_name_en+"</div>","th"==config.DataFormat?(i+='<div class="table-column"><div class="bg-blue" style="background-color: rgb('+o.daily_th_color+');">'+o.daily_pm25+"</div></div>",i+='<div class="table-column"><div class="bg-blue" style="background-color: rgb('+o.daily_th_color+');">'+o.daily_pm25_th_aqi+"</div></div>"):(i+='<div class="table-column"><div class="bg-blue" style="background-color: rgb('+o.daily_us_color+');">'+o.daily_pm25+"</div></div>",i+='<div class="table-column"><div class="bg-blue" style="background-color: rgb('+o.daily_us_color+');">'+o.daily_pm25_us_aqi+"</div></div>"),i+="</button></div></div>",0==a&&(config.station_point||(config.station_point=o.id)),a++)):(e++,"All"==config.pm_top&&o.daily_pm25>0?(config.pm_region||$(".update-time").html("ข้อมูลเฉลี่ยรายวัน "+convertDateFormatDay(o.log_datetime)+" "+convertDateFormatHour(o.log_datetime),pathname),i+='<div><div class="table-row" id="row_'+o.id+'"><button class="btn btn-table" onclick="nearStation2('+o.id+')">',i+='<div class="table-column">'+e+"</div>","th"==config.DataLang?i+='<div class="table-column table-column-custom">'+o.dustboy_name+"</div>":i+='<div class="table-column table-column-custom">'+o.dustboy_name_en+"</div>","th"==config.DataFormat?(i+='<div class="table-column"><div class="bg-blue" style="background-color: rgb('+o.daily_th_color+');">'+o.daily_pm25+"</div></div>",i+='<div class="table-column"><div class="bg-blue" style="background-color: rgb('+o.daily_th_color+');">'+o.daily_pm25_th_aqi+"</div></div>"):(i+='<div class="table-column"><div class="bg-blue" style="background-color: rgb('+o.daily_us_color+');">'+o.daily_pm25+"</div></div>",i+='<div class="table-column"><div class="bg-blue" style="background-color: rgb('+o.daily_us_color+');">'+o.daily_pm25_us_aqi+"</div></div>"),i+="</button></div></div>",0==a&&(config.station_point||(config.station_point=o.id)),a++):e<=config.pm_top&&o.daily_pm25>0&&(config.pm_region||$(".update-time").html("ข้อมูลเฉลี่ยรายชั่วโมง "+convertDateFormatDay(o.log_datetime)+" "+convertDateFormatHour(o.log_datetime),pathname),i+='<div><div class="table-row" id="row_'+o.id+'"><button class="btn btn-table" onclick="nearStation2('+o.id+')">',i+='<div class="table-column">'+e+"</div>","th"==config.DataLang?i+='<div class="table-column table-column-custom">'+o.dustboy_name+"</div>":i+='<div class="table-column table-column-custom">'+o.dustboy_name_en+"</div>","th"==config.DataFormat?(i+='<div class="table-column"><div class="bg-blue" style="background-color: rgb('+o.daily_th_color+');">'+o.daily_pm25+"</div></div>",i+='<div class="table-column"><div class="bg-blue" style="background-color: rgb('+o.daily_th_color+');">'+o.daily_pm25_th_aqi+"</div></div>"):(i+='<div class="table-column"><div class="bg-blue" style="background-color: rgb('+o.daily_us_color+');">'+o.daily_pm25+"</div></div>",i+='<div class="table-column"><div class="bg-blue" style="background-color: rgb('+o.daily_us_color+');">'+o.daily_pm25_us_aqi+"</div></div>"),i+="</button></div></div>",0==a&&(config.station_point||(config.station_point=o.id)),a++))}),$("#tblResult").html(o+i+"</div></div></div></div>"),$("#tblResult").show(),$(".standard_sqi_legend_footer").show(),a>0&&$(".loader").hide()}}function filter(){for(var t=document.getElementById("txt_search").value,a=document.getElementById("select-search"),o=0;o<a.length;o++){a.options[o].text.substring(0,t.length).toLowerCase()!==t.toLowerCase()&&""!==t.trim()?$(a.options[o]).attr("disabled","disabled").hide():$(a.options[o]).removeAttr("disabled").show()}}function getTblPMHourResult(){if(config.pmLocations){var t;config.province_sel&&$("#rgname").html("อันดับค่าฝุ่น จังหวัด"+getProvinceName(config.province_sel)),t="th"==config.DataLang?optionText_th:optionText_en;var a=0,o='<div class="row"><div class="col-12"><div class="table hourly"><div class="table-head"><div class="table-row"><div class="table-column">'+t.hour_no+'</div><div class="table-column" style="display: flex;">'+t.hour_name+'</div><div class="table-column">'+t.hour_value+'</div><div class="table-column">'+t.hour_value10+'</div></div></div><div class="table-body">',i="",e=0;$.each(config.pmLocations,function(t,o){config.province_sel?o.province_code==config.province_sel&&(e++,"All"==config.pm_top?(config.pm_region||$(".update-time").html("ข้อมูลเฉลี่ยรายชั่วโมง "+convertDateFormatDay(o.log_datetime)+" "+convertDateFormatHour(o.log_datetime),pathname),i+='<div><div class="table-row" id="row_'+o.id+'"><button class="btn btn-table" onclick="nearStation('+o.id+')">',i+='<div class="table-column">'+e+"</div>","th"==config.DataLang?i+='<div class="table-column table-column-custom">'+o.dustboy_name+"</div>":i+='<div class="table-column table-column-custom">'+o.dustboy_name_en+"</div>","th"==config.DataFormat?i+='<div class="table-column"><div class="bg-blue" style="background-color: rgb('+o.th_color+');">'+o.pm25+"</div></div>":i+='<div class="table-column"><div class="bg-blue" style="background-color: rgb('+o.us_color+');">'+o.pm25+"</div></div>",i+='<div class="table-column"><div class="bg-blue" style="background-color: rgb(165,165,165);">'+o.pm10+"</div></div>",i+="</button></div></div>",0==a&&(config.station_point||(config.station_point=o.id)),a++):e<=config.pm_top&&(config.pm_region||$(".update-time").html("ข้อมูลเฉลี่ยรายชั่วโมง "+convertDateFormatDay(o.log_datetime)+" "+convertDateFormatHour(o.log_datetime),pathname),i+='<div><div class="table-row" id="row_'+o.id+'"><button class="btn btn-table" onclick="nearStation('+o.id+')">',i+='<div class="table-column">'+e+"</div>","th"==config.DataLang?i+='<div class="table-column table-column-custom">'+o.dustboy_name+"</div>":i+='<div class="table-column table-column-custom">'+o.dustboy_name_en+"</div>","th"==config.DataFormat?i+='<div class="table-column"><div class="bg-blue" style="background-color: rgb('+o.th_color+');">'+o.pm25+"</div></div>":i+='<div class="table-column"><div class="bg-blue" style="background-color: rgb('+o.us_color+');">'+o.pm25+"</div></div>",i+='<div class="table-column"><div class="bg-blue" style="background-color: rgb(165,165,165);">'+o.pm10+"</div></div>",i+="</button></div></div>",0==a&&(config.station_point||(config.station_point=o.id)),a++)):(e++,"All"==config.pm_top?(config.pm_region||$(".update-time").html("ข้อมูลเฉลี่ยรายชั่วโมง "+convertDateFormatDay(o.log_datetime)+" "+convertDateFormatHour(o.log_datetime),pathname),i+='<div><div class="table-row" id="row_'+o.id+'"><button class="btn btn-table" onclick="nearStation('+o.id+')">',i+='<div class="table-column">'+e+"</div>","th"==config.DataLang?i+='<div class="table-column table-column-custom">'+o.dustboy_name+"</div>":i+='<div class="table-column table-column-custom">'+o.dustboy_name_en+"</div>","th"==config.DataFormat?i+='<div class="table-column"><div class="bg-blue" style="background-color: rgb('+o.th_color+');">'+o.pm25+"</div></div>":i+='<div class="table-column"><div class="bg-blue" style="background-color: rgb('+o.us_color+');">'+o.pm25+"</div></div>",i+='<div class="table-column"><div class="bg-blue" style="background-color: rgb(165,165,165);">'+o.pm10+"</div></div>",i+="</button></div></div>",0==a&&(config.station_point||(config.station_point=o.id)),a++):e<=config.pm_top&&(config.pm_region||$(".update-time").html("ข้อมูลเฉลี่ยรายชั่วโมง "+convertDateFormatDay(o.log_datetime)+" "+convertDateFormatHour(o.log_datetime),pathname),i+='<div><div class="table-row" id="row_'+o.id+'"><button class="btn btn-table" onclick="nearStation('+o.id+')">',i+='<div class="table-column">'+e+"</div>","th"==config.DataLang?i+='<div class="table-column table-column-custom">'+o.dustboy_name+"</div>":i+='<div class="table-column table-column-custom">'+o.dustboy_name_en+"</div>","th"==config.DataFormat?i+='<div class="table-column"><div class="bg-blue" style="background-color: rgb('+o.th_color+');">'+o.pm25+"</div></div>":i+='<div class="table-column"><div class="bg-blue" style="background-color: rgb('+o.us_color+');">'+o.pm25+"</div></div>",i+='<div class="table-column"><div class="bg-blue" style="background-color: rgb(165,165,165);">'+o.pm10+"</div></div>",i+="</button></div></div>",0==a&&(config.station_point||(config.station_point=o.id)),a++))}),$("#tblResult").html(o+i+"</div></div></div></div>"),$("#tblResult").show(),$(".standard_sqi_legend_footer").show(),a>0&&$(".loader").hide()}}function nearStation2(t){var a,o;if(config.station_point=t,"rank-dailys"==pathname&&$.each(config.pmLocations,function(t,i){i.id==config.station_point&&(config.curentStation=i,a=i.dustboy_name,o=i.th_title,"en"==config.DataLang&&(a=i.dustboy_name_en,o=i.th_title_en))}),$(".card-marker").remove(),"th"==config.DataFormat){var i='<div class="card card-marker" style="display: block; padding: 0px;">';i+='\t<div class="card-body" style="background-color: rgb('+config.curentStation.daily_th_color+');">',i+='\t\t<button type="button" class="btn btn-close" style="background-color: rgb('+config.curentStation.daily_th_color+');"><img alt="image" src="/template/image/icon-close.svg" width="14" height="14" /></button>',i+='\t\t<h5 class="card-title">'+a+"</h5>",i+='\t\t<div class="card-description"> <div class="card-cover"> <img alt="image" src="/template/image/'+config.curentStation.daily_th_dustboy_icon+'" width="59" height="85"/> </div><div class="card-quality"> <div class="card-value">'+config.curentStation.daily_pm25+'</div><div class="card-info"> PM2.5 (μg/m<sup>3</sup>) </div></div></div>',i+='\t\t<div class="card-description"> <div class="card-detail card-detail-custom"> <h4>'+o+"</h4> </div></div>",i+="\t</div>",i+='\t<div class="card-footer" style="background-color: rgb('+config.curentStation.daily_th_color+');"> <div class="card-items card-items-footer"> <div class="card-date"><span class="data-date">'+convertDateFormatDay(config.curentStation.log_datetime,pathname)+'</span><span class="data-time">'+convertDateFormatHour(config.curentStation.log_datetime,pathname)+'</span> </div></div><a target="_blank" href="/station/'+config.curentStation.id+'" class="btn-favorite"><img alt="image" src="/template/image/icon-info-w.svg" width="18" height="17"/></a> </div>',i+="</div>"}else{i='<div class="card card-marker" style="display: block; padding: 0px;">';i+='\t<div class="card-body" style="background-color: rgb('+config.curentStation.daily_us_color+');">',i+='\t\t<button type="button" class="btn btn-close" style="background-color: rgb('+config.curentStation.daily_us_color+');"><img alt="image" src="/template/image/icon-close.svg" width="14" height="14" /></button>',i+='\t\t<h5 class="card-title">'+a+"</h5>",i+='\t\t<div class="card-description"> <div class="card-cover"> <img alt="image" src="/template/image/'+config.curentStation.daily_us_dustboy_icon+'" width="59" height="85"/> </div><div class="card-quality"> <div class="card-value">'+config.curentStation.daily_pm25+'</div><div class="card-info"> PM2.5 (μg/m<sup>3</sup>) </div></div></div>',i+='\t\t<div class="card-description"> <div class="card-detail card-detail-custom"> <h4>'+o+"</h4> </div></div>",i+="\t</div>",i+='\t<div class="card-footer" style="background-color: rgb('+config.curentStation.daily_us_color+');"> <div class="card-items card-items-footer"> <div class="card-date"><span class="data-date">'+convertDateFormatDay(config.curentStation.log_datetime,pathname)+'</span><span class="data-time">'+convertDateFormatHour(config.curentStation.log_datetime,pathname)+'</span> </div></div><a target="_blank" href="/station/'+config.curentStation.id+'" class="btn-favorite"><img alt="image" src="/template/image/icon-info-w.svg" width="18" height="17"/></a> </div>',i+="</div>"}$("#row_"+t).before(i)}function nearStation(t){var a,o;if(config.station_point=t,"rank-hours"==pathname&&$.each(config.pmLocations,function(t,i){i.id==config.station_point&&(config.curentStation=i,a=i.dustboy_name,o=i.th_title,"en"==config.DataLang&&(a=i.dustboy_name_en,o=i.th_title_en))}),"rank-dailys"==pathname&&$.each(config.pmLocations,function(t,i){i.id==config.station_point&&(config.curentStation=i,a=i.dustboy_name,o=i.th_title,"en"==config.DataLang&&(a=i.dustboy_name_en,o=i.th_title_en))}),"pmhours"==pathname&&$.each(config.pmLocations,function(i,e){e.id==t&&(config.curentStation=e,a=e.dustboy_name,o=e.th_title,"en"==config.DataLang&&(a=e.dustboy_name_en,o=e.th_title_en))}),$(".card-marker").remove(),"th"==config.DataFormat){var i='<div class="card card-marker" style="display: block; padding: 0px;">';i+='\t<div class="card-body" style="background-color: rgb('+config.curentStation.th_color+');">',i+='\t\t<button type="button" class="btn btn-close" style="background-color: rgb('+config.curentStation.th_color+');"><img alt="image" src="/template/image/icon-close.svg" width="14" height="14" /></button>',i+='\t\t<h5 class="card-title">'+a+"</h5>",i+='\t\t<div class="card-description"> <div class="card-cover"> <img alt="image" src="/template/image/'+config.curentStation.th_dustboy_icon+'" width="59" height="85"/> </div><div class="card-quality"> <div class="card-value">'+config.curentStation.pm25+'</div><div class="card-info"> PM2.5 (μg/m<sup>3</sup>) </div></div></div>',i+='\t\t<div class="card-description"> <div class="card-detail card-detail-custom"> <h4>'+o+"</h4> </div></div>",i+="\t</div>",i+='\t<div class="card-footer" style="background-color: rgb('+config.curentStation.th_color+');"> <div class="card-items card-items-footer"> <div class="card-date"><span class="data-date">'+convertDateFormatDay(config.curentStation.log_datetime,pathname)+'</span><span class="data-time">'+convertDateFormatHour(config.curentStation.log_datetime,pathname)+'</span><span class="data-pm10">| PM10 '+config.curentStation.pm10+' (μg/m<sup>3</sup>)</span></div></div><a target="_blank" href="/station/'+config.curentStation.id+'" class="btn-favorite"><img alt="image" src="/template/image/icon-info-w.svg" width="18" height="17"/></a> </div>',i+="</div>"}else{i='<div class="card card-marker" style="display: block; padding: 0px;">';i+='\t<div class="card-body" style="background-color: rgb('+config.curentStation.us_color+');">',i+='\t\t<button type="button" class="btn btn-close" style="background-color: rgb('+config.curentStation.us_color+');"><img alt="image" src="/template/image/icon-close.svg" width="14" height="14" /></button>',i+='\t\t<h5 class="card-title">'+a+"</h5>",i+='\t\t<div class="card-description"> <div class="card-cover"> <img alt="image" src="/template/image/'+config.curentStation.us_dustboy_icon+'" width="59" height="85"/> </div><div class="card-quality"> <div class="card-value">'+config.curentStation.pm25+'</div><div class="card-info"> PM2.5 (μg/m<sup>3</sup>) </div></div></div>',i+='\t\t<div class="card-description"> <div class="card-detail card-detail-custom"> <h4>'+o+"</h4> </div></div>",i+="\t</div>",i+='\t<div class="card-footer" style="background-color: rgb('+config.curentStation.us_color+');"> <div class="card-items card-items-footer"> <div class="card-date"><span class="data-date">'+convertDateFormatDay(config.curentStation.log_datetime,pathname)+'</span><span class="data-time">'+convertDateFormatHour(config.curentStation.log_datetime,pathname)+'</span><span class="data-pm10">| PM10 '+config.curentStation.pm10+' (μg/m<sup>3</sup>)</span></div></div><a target="_blank" href="/station/'+config.curentStation.id+'" class="btn-favorite"><img alt="image" src="/template/image/icon-info-w.svg" width="18" height="17"/></a> </div>',i+="</div>"}$("#row_"+t).before(i)}function fn_setFormat(){for(var t="th"==config.DataFormat?config.setStandardAqi[0].th_aqi:config.setStandardAqi[0].us_aqi,a="",o="",i=0;i<t.pm25.length;++i)a+='<td class="table-col" style="background-color: rgb('+t.aqi[i].color+');"><img width="20" src="/template/image/'+t.aqi[i].dustboy_icon+'"></td>',i==t.pm25.length-1?o+='<td class="table-col" style="background-color: rgb('+t.pm25[i].color+');">>'+t.pm25[i-1].max+"</td>":o+='<td class="table-col" style="background-color: rgb('+t.pm25[i].color+');">'+t.pm25[i].min+"-"+t.pm25[i].max+"</td>";var e='<table class="table">';e+="<tbody>",e+='<tr><td class="table-head">PM<sub>2.5</sub>(μg/m<sup>3</sup>)</td>',e+=o,e+="</tr>",e+='<tr><td class="table-head"></td>',e+=a,e+="</tr>",e+="</tbody>",e+="</table>",$(".standard_sqi_legend_footer").html(e)}"contactus"==(pathname=pathname.replace("/",""))&&($("#pills-tab").hide(),$("#pills-tab2").hide()),"snapshot"==pathname&&($("#pills-tab").hide(),$("#pills-tab2").hide()),"news"==pathname&&($("#pills-tab").hide(),$("#pills-tab2").hide()),"definition"==pathname&&($("#pills-tab").hide(),$("#pills-tab2").hide()),"newsdetail"==pathname.substring(0,10)&&($("#pills-tab").hide(),$("#pills-tab2").hide()),"rank-hours"==pathname&&$("#pills-tab2").hide(),"rank-dailys"==pathname&&$("#pills-tab2").hide(),"forecast"==pathname.substring(0,8)&&($("#pills-tab").show(),$("#pills-tab2").hide()),"prophecy"==pathname.substring(0,8)&&($("#pills-tab").hide(),$("#pills-tab2").hide()),"station"==pathname.substring(0,7)&&($("#pills-tab").show(),$("#pills-tab2").hide()),"dailyreport"==pathname.substring(0,11)&&($("#pills-tab").hide(),$("#pills-tab2").hide()),$(document).ready(function(){if($(".btn-search").on("click",function(){var t=$("#select-search").val();config.province_sel=t||null,"rank-hours"==pathname&&getTblPMHourResult(),"rank-dailys"==pathname&&getTblPMDayResult(),$("#searchModel").modal("hide")}),$(".btn-menu").on("click",function(){$("#sidebar").toggleClass("active"),$(".overlay").toggleClass("active")}),$(".overlay").on("click",function(){$(this).hasClass("active")&&($(".overlay").removeClass("active"),$("#sidebar").removeClass("active"))}),$("#pills-tab .nav-link").on("click",function(){$("#pills-tab .nav-link").removeClass("active"),$(this).addClass("active"),config.DataFormat=$(this).attr("dformat"),fn_setFormat(),"pmhours"==pathname&&null!=config.pmLocations&&(getTblResult(),nearStation(config.station_point)),"rank-hours"==pathname&&null!=config.pmLocations&&(getTblPMHourResult(),nearStation(config.station_point)),"rank-dailys"==pathname&&null!=config.pmLocations&&(getTblPMDayResult(),nearStation2(config.station_point)),"forecast"==pathname.substring(0,8)&&config.rsForecast&&createForecastChart(),"prophecy"==pathname.substring(0,8)&&config.rsProphecy&&createProphecy(config.rsProphecy_region)}),$(".choose-lang").on("click",function(){"th"==$(this).attr("data-lang")?(config.DataLang="th",$('.choose-lang[data-lang="en"]').removeClass("choose-lang-active"),$('.choose-lang[data-lang="en"]').addClass("choose-lang-inactive"),$('.choose-lang[data-lang="th"]').removeClass("choose-lang-inactive"),$('.choose-lang[data-lang="th"]').addClass("choose-lang-active"),$(".menu-title").each(function(t,a){var o=$(this).attr("menu-th");$(this).html(o)})):(config.DataLang="en",$('.choose-lang[data-lang="th"]').removeClass("choose-lang-active"),$('.choose-lang[data-lang="th"]').addClass("choose-lang-inactive"),$('.choose-lang[data-lang="en"]').removeClass("choose-lang-inactive"),$('.choose-lang[data-lang="en"]').addClass("choose-lang-active"),$(".menu-title").each(function(t,a){var o=$(this).attr("menu-en");$(this).html(o)})),"pmhours"==pathname&&null!=config.pmLocations&&(getTblResult(),nearStation(config.station_point)),"rank-hours"==pathname&&null!=config.pmLocations&&(getTblPMHourResult(),nearStation(config.station_point)),"rank-dailys"==pathname&&null!=config.pmLocations&&(getTblPMDayResult(),nearStation2(config.station_point)),"forecast"==pathname.substring(0,8)&&config.rsForecast&&createForecastChart()}),"pmhours"==pathname){function t(t){null!=t.coords.latitude&&null!=t.coords.longitude&&(config.location.lat=t.coords.latitude,config.location.lon=t.coords.longitude,$.getJSON("https://www-old.cmuccdc.org/api2/dustboy/near/"+config.location.lat+"/"+config.location.lon,function(t){config.pmLocations=t,getTblResult()}))}$("#pills-tab2").hide(),navigator.geolocation&&navigator.geolocation.getCurrentPosition(t),$(".btn-locations").on("click",function(){var t=$.trim($(this).html());$(".btn-locations").removeClass("btn-success"),$(".btn-locations").addClass("btn-secondary"),$(this).removeClass("btn-secondary"),$(this).addClass("btn-success"),config.location.dis=t,getTblResult()})}if("rank-hours"==pathname){var a="";if(getUrlParameter("region"))config.pm_region=getUrlParameter("region"),(i=[]).north=1,i.central=2,i.northeast=3,i.western=4,i.south=6,i.eastern=5,a=i[config.pm_region];$.getJSON("https://www-old.cmuccdc.org/api2/dustboy/rankingnrct/hourly/"+a,function(t){config.pmLocations=t,config.pm_region&&($("#rgname").html("อันดับค่าฝุ่น "+t.zone_name_th),$(".update-time").html("ข้อมูลเฉลี่ยรายชั่วโมง "+convertDateFormatDay(t.log_datetime)+" "+convertDateFormatHour(t.log_datetime),pathname),config.pmLocations=t.stations),getTblPMHourResult()}),$(".btn-top").on("click",function(){config.pm_top=$(this).attr("top"),$(".btn-top").removeClass("btn-success"),$(".btn-top").addClass("btn-secondary"),$(this).addClass("btn-success"),getTblPMHourResult()}),e(a)}if("rank-dailys"==pathname){a="";if(getUrlParameter("region"))config.pm_region=getUrlParameter("region"),(i=[]).north=1,i.central=2,i.northeast=3,i.western=4,i.south=6,i.eastern=5,a=i[config.pm_region];$.getJSON("https://www-old.cmuccdc.org/api2/dustboy/rankingnrct/daily/"+a,function(t){config.pmLocations=t,config.pm_region&&($("#rgname").html("อันดับค่าฝุ่น "+t.zone_name_th),$(".update-time").html("ข้อมูลเฉลี่ยรายชั่วโมง "+convertDateFormatDay(t.log_datetime)+" "+convertDateFormatHour(t.log_datetime),pathname),config.pmLocations=t.stations),getTblPMDayResult()}),$(".btn-top").on("click",function(){config.pm_top=$(this).attr("top"),$(".btn-top").removeClass("btn-success"),$(".btn-top").addClass("btn-secondary"),$(this).addClass("btn-success"),getTblPMDayResult()}),e(a)}if("forecast"==pathname.substring(0,8)){var o=pathname.split("/");o&&$.getJSON("https://www-old.cmuccdc.org/api2/dustboy/forecast/"+o[1],function(t){config.rsForecast=t,config.rsForecast&&createForecastChart()})}if("prophecy"==pathname.substring(0,8)){var i;a="";if(getUrlParameter("region"))config.pm_region=getUrlParameter("region"),(i=[]).north=1,i.central=2,i.northeast=3,i.western=4,i.eastern=5,i.south=6,i.other=7,config.rsProphecy_region=i[config.pm_region];$.getJSON("https://www-old.cmuccdc.org/api2/dustboy/regionreport",function(t){config.rsProphecy=t,config.rsProphecy&&createProphecy(config.rsProphecy_region)})}function e(t){$.getJSON("/template/plugins/region_pwa.json",function(a){if(config.province_all=a,a){var o="";for(let i=0;i<a.length;i++)if(t){if(t==a[i].zone_id){if(o+='<optgroup label="'+a[i].zone_name_th+'">',a[i].provinces.length>0)for(let t=0;t<a[i].provinces.length;t++)o+='<option value="'+a[i].provinces[t].province_code+'">'+a[i].provinces[t].province_name_th+"</option>";o+="</optgroup>"}}else{if(o+='<optgroup label="'+a[i].zone_name_th+'">',a[i].provinces.length>0)for(let t=0;t<a[i].provinces.length;t++)o+='<option value="'+a[i].provinces[t].province_code+'">'+a[i].provinces[t].province_name_th+"</option>";o+="</optgroup>"}$("#select-search").html(o)}})}if("contactus"==pathname&&$.get("/googleanalytics/HelloAnalytics.php",function(t){$("#analyticsstat").html(t)}),"snapshot"==pathname){function n(t,a){var o="";$.getJSON("https://www-old.cmuccdc.org/api2/dustboy/snapshot/"+t+"/"+a,function(t){o+='<div class="row">',t[0]?$.each(t[0].snapshots,function(t,a){o+='<div class="col-sm-4" style="margin-bottom:15px;position: relative;">',o+='<span style="position: absolute;background-color: #9dc02d;padding: 2px;color: #fff;">'+a.lastupdated+"</span>",o+='<a target="_blank" href="'+a.image_url+'"><img src="'+a.image_url+'" class="img-fluid"/></a></div>'}):o+='<div class="col-md-12"><p class="text-center"> ไม่พบข้อมูล </p></div>',o+="</div>",$(".loader").hide(),$("#display_snapshot").html(o)})}$(".datetime").datepicker({format:"yyyy-mm-dd"}),n($("#source").val(),$("#dateStart").val()),$("#btn-filter").on("click",function(){$(".loader").show(),$("#display_snapshot").html(""),n($("#source").val(),$("#dateStart").val(),$("#stime").val())})}"news"==pathname&&($("#news-page-news-feed .news-slice").slice(0,6).show(),$(".news-see-more-btn").on("click",function(t){t.preventDefault(),$("#news-page-news-feed .news-slice:hidden").slice(0,6).slideDown(),0===$("#news-page-news-feed .news-slice:hidden").length&&$(".news-see-more-btn").addClass("disabled btn")}))});var getUrlParameter=function(t){var a,o,i=window.location.search.substring(1).split("&");for(o=0;o<i.length;o++)if((a=i[o].split("="))[0]===t)return void 0===typeof a[1]||decodeURIComponent(a[1]);return!1};$(window).on("load",function(){$.getJSON("/template/plugins/standard_aqi.json?v=1",function(t){config.setStandardAqi=t,fn_setFormat()})});